<div [class.dark]="theme.isDark()">
  <div class="min-h-screen bg-stone-50 dark:bg-stone-900 transition-colors">
  <!-- Navegaci√≥n -->
  <header class="border-b border-stone-200 dark:border-stone-700 bg-white/80 dark:bg-stone-800/80 backdrop-blur-sm sticky top-0 z-10 transition-colors">
    <nav class="max-w-5xl mx-auto px-4 py-2 flex items-center justify-between">
      <a routerLink="/" (click)="closeMobileMenu()" class="text-xl font-semibold text-stone-800 dark:text-stone-100 tracking-tight shrink-0">
        Agenda Worship
      </a>

      <!-- Escritorio: enlaces en fila -->
      <div class="hidden md:flex items-center gap-4">
        <a routerLink="/" routerLinkActive="text-amber-600 dark:text-amber-400 font-medium" [routerLinkActiveOptions]="{ exact: true }"
           class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 transition-colors">
          Inicio
        </a>
        <a routerLink="/miembros" routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
           class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 transition-colors">
          Miembros
        </a>
        <a routerLink="/agenda" routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
           class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 transition-colors">
          Agenda Mensual
        </a>
        <a routerLink="/canciones" routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
           class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 transition-colors">
          Canciones
        </a>
        <a routerLink="/calendario" routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
           class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 transition-colors">
          Calendario El Camino
        </a>
        @if (adminAuth.isAdmin()) {
          <button type="button"
                  (click)="logoutAdmin()"
                  class="text-sm font-medium text-amber-600 dark:text-amber-400 hover:text-amber-700 dark:hover:text-amber-300 transition-colors">
            Cerrar sesi√≥n (admin)
          </button>
        } @else {
          <button type="button"
                  (click)="openAdminModal()"
                  class="text-sm font-medium text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 transition-colors">
            Acceso administrador
          </button>
        }
        <button type="button"
                (click)="theme.toggle()"
                [attr.aria-label]="theme.isDark() ? 'Activar modo claro' : 'Activar modo oscuro'"
                class="rounded-lg p-2 text-stone-600 dark:text-stone-400 hover:bg-stone-200 dark:hover:bg-stone-700 transition-colors">
          @if (theme.isDark()) {
            <span class="text-lg" aria-hidden="true">‚òÄÔ∏è</span>
          } @else {
            <span class="text-lg" aria-hidden="true">üåô</span>
          }
        </button>
      </div>

      <!-- M√≥vil: bot√≥n hamburguesa + tema -->
      <div class="flex md:hidden items-center gap-1">
        <button type="button"
                (click)="theme.toggle()"
                [attr.aria-label]="theme.isDark() ? 'Activar modo claro' : 'Activar modo oscuro'"
                class="rounded-lg p-2 text-stone-600 dark:text-stone-400 hover:bg-stone-200 dark:hover:bg-stone-700 transition-colors">
          @if (theme.isDark()) {
            <span class="text-lg" aria-hidden="true">‚òÄÔ∏è</span>
          } @else {
            <span class="text-lg" aria-hidden="true">üåô</span>
          }
        </button>
        <button type="button"
                (click)="toggleMobileMenu()"
                [attr.aria-label]="mobileMenuOpen() ? 'Cerrar men√∫' : 'Abrir men√∫'"
                [attr.aria-expanded]="mobileMenuOpen()"
                class="rounded-lg p-2.5 text-stone-600 dark:text-stone-400 hover:bg-stone-200 dark:hover:bg-stone-700 transition-colors">
          @if (mobileMenuOpen()) {
            <span class="text-xl leading-none" aria-hidden="true">‚úï</span>
          } @else {
            <span class="flex flex-col gap-1" aria-hidden="true">
              <span class="block w-5 h-0.5 bg-current rounded"></span>
              <span class="block w-5 h-0.5 bg-current rounded"></span>
              <span class="block w-5 h-0.5 bg-current rounded"></span>
            </span>
          }
        </button>
      </div>
    </nav>

    <!-- Men√∫ m√≥vil desplegable -->
    @if (mobileMenuOpen()) {
      <div class="md:hidden border-t border-stone-200 dark:border-stone-700 bg-white dark:bg-stone-800/95 backdrop-blur-sm">
        <div class="max-w-5xl mx-auto px-4 py-3 flex flex-col gap-1">
          <a routerLink="/" (click)="closeMobileMenu()"
             routerLinkActive="text-amber-600 dark:text-amber-400 font-medium" [routerLinkActiveOptions]="{ exact: true }"
             class="py-2.5 px-3 rounded-lg text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
            Inicio
          </a>
          <a routerLink="/miembros" (click)="closeMobileMenu()"
             routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
             class="py-2.5 px-3 rounded-lg text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
            Miembros
          </a>
          <a routerLink="/agenda" (click)="closeMobileMenu()"
             routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
             class="py-2.5 px-3 rounded-lg text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
            Agenda Mensual
          </a>
          <a routerLink="/canciones" (click)="closeMobileMenu()"
             routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
             class="py-2.5 px-3 rounded-lg text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
            Canciones
          </a>
          <a routerLink="/calendario" (click)="closeMobileMenu()"
             routerLinkActive="text-amber-600 dark:text-amber-400 font-medium"
             class="py-2.5 px-3 rounded-lg text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
            Calendario El Camino
          </a>
          @if (adminAuth.isAdmin()) {
            <button type="button"
                    (click)="logoutAdmin(); closeMobileMenu()"
                    class="py-2.5 px-3 rounded-lg text-left text-sm font-medium text-amber-600 dark:text-amber-400 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
              Cerrar sesi√≥n (admin)
            </button>
          } @else {
            <button type="button"
                    (click)="openAdminModal(); closeMobileMenu()"
                    class="py-2.5 px-3 rounded-lg text-left text-sm font-medium text-stone-700 dark:text-stone-200 hover:bg-stone-100 dark:hover:bg-stone-700/50 transition-colors">
              Acceso administrador
            </button>
          }
        </div>
      </div>
    }
  </header>

  <!-- Contenido principal -->
  <main class="max-w-5xl mx-auto px-4 pt-4 pb-6">
    <router-outlet />
  </main>

  <!-- Modal acceso administrador -->
  @if (showAdminModal()) {
    <div class="fixed inset-0 z-50 flex items-center justify-center p-4"
         role="dialog"
         aria-modal="true"
         aria-labelledby="admin-modal-title">
      <div class="fixed inset-0 bg-black/50" (click)="closeAdminModal()"></div>
      <div class="relative z-10 w-full max-w-sm rounded-2xl border border-stone-200 dark:border-stone-600 bg-white dark:bg-stone-800 p-6 shadow-xl">
        <h2 id="admin-modal-title" class="text-lg font-semibold text-stone-800 dark:text-stone-100">Acceso administrador</h2>
        <p class="mt-1 text-sm text-stone-500 dark:text-stone-400">Ingresa la contrase√±a para editar canciones, agenda y calendario.</p>
        <div class="mt-4">
          <label for="admin-password" class="block text-xs font-medium text-stone-500 dark:text-stone-400 mb-1">Contrase√±a</label>
          <input id="admin-password"
                 type="password"
                 [ngModel]="adminPassword()"
                 (ngModelChange)="adminPassword.set($event); adminError.set(false)"
                 (keydown.enter)="submitAdminLogin()"
                 placeholder="Contrase√±a"
                 class="w-full rounded-lg border border-stone-200 dark:border-stone-600 bg-stone-50 dark:bg-stone-700 px-3 py-2 text-stone-800 dark:text-stone-200 focus:border-amber-500 focus:outline-none focus:ring-1 focus:ring-amber-500"
                 autocomplete="current-password">
          @if (adminError()) {
            <p class="mt-2 text-sm text-red-600 dark:text-red-400">Contrase√±a incorrecta.</p>
          }
        </div>
        <div class="mt-4 flex justify-end gap-2">
          <button type="button"
                  (click)="closeAdminModal()"
                  class="rounded-lg border border-stone-200 dark:border-stone-600 px-4 py-2 text-sm font-medium text-stone-700 dark:text-stone-300 hover:bg-stone-100 dark:hover:bg-stone-700">
            Cancelar
          </button>
          <button type="button"
                  (click)="submitAdminLogin()"
                  class="rounded-lg bg-amber-600 px-4 py-2 text-sm font-medium text-white hover:bg-amber-700">
            Entrar
          </button>
        </div>
      </div>
    </div>
  }
  </div>
</div>
